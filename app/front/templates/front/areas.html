{% extends "base.html" %} {% block content %} {% load static %} {% if user.is_staff %}
<script src="{% static 'front/areas.js' %}"></script>

<div class="pb-5 pt-3 bg-light w-100">
  <div class="container-xxl">
    <div class="d-flex justify-content-between align-items-end">
      <div class="d-flex align-items-end">
        <h2 class="m-0 me-2">Áreas</h2>
      </div>
    </div>
    <hr />
    <div class="accordion" id="accordionAreas">
      {% for area in areas %}
      <div class="accordion-item">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{area.id}}" aria-expanded="false" aria-controls="collapse{{area.id}}">
            {{area.nombre_es}}
          </button>
        </h2>
        <div id="collapse{{area.id}}" class="accordion-collapse collapse" data-bs-parent="#accordionAreas">
          <div class="accordion-body">
            <h5>Subáreas</h5>
            <p class="text-muted">Editar nombres en Español e Inglés:</p>
            {% for subarea in area.sub_areas %}
            <form action="{% url 'persona:subarea_action' %}" id="subareaAction{{subarea.id}}" method="post">
              {% csrf_token %}
              <div class="input-group mb-3">
                <input type="text" name="subareaNombreEs" id="subareaNombreEs{{subarea.id}}" class="form-control" placeholder="Subárea (Español)" aria-label="Subárea (Español)" value="{{subarea.nombre_es}}">
                <input type="text" name="subareaNombreEn" id="subareaNombreEn{{subarea.id}}" class="form-control" placeholder="Subárea (Inglés)" aria-label="Subárea (Inglés)" value="{{subarea.nombre_en}}">
                <input type="hidden" name="subareaID" value="{{subarea.id}}">
                <input type="hidden" name="areaID" value="{{area.id}}">
                <input type="hidden" name="action" value="edit" id="action{{subarea.id}}">
                <button type="button" class="btn btn-secondary" onclick="validate_form_edit_subarea('{{subarea.id}}')">Editar</button>
                <button type="button" class="btn btn-danger" onclick="validate_form_remove_subarea('{{subarea.id}}')">Eliminar</button>
              </div>
            </form>
            {% endfor %}
            <hr />
            <h5>Nueva Subárea</h5>
            <form action="{% url 'persona:subarea_new' %}" id="subareaNew{{area.id}}" method="post">
              {% csrf_token %}
              <div class="input-group mb-3">
                <input type="hidden" name="areaID" value="{{area.id}}">
                <input type="text" class="form-control" name="subareaNombreEs" id="subareaNombreEsNew{{area.id}}" placeholder="Subárea (Español)" required>
                <input type="text" class="form-control" name="subareaNombreEn" id="subareaNombreEnNew{{area.id}}" placeholder="Subárea (Inglés)" required>
                <button type="button" class="btn btn-primary" onclick="validate_form_new_subarea('{{area.id}}')">Guardar</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% endif %} {% endblock content %}
